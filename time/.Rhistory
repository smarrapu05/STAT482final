for(i in 1:50){
xsamples[i] <- rexp(100,rate = 100)
}
#q2 part b
rm(list=ls())
basicCIfx <- function(x){
n= length(x)
thest = mean(x)
B = 9999
thestS = numeric(B)
thestS = rep(0,times =B)
for (i in 1:B)
thestS[i] = mean(sample(x,replace=T))
RS = sort(thestS-thest)
LRS = RS[250]
URS = RS[9750]
thL = thest-URS
thU = thest-LRS
basicCI <- c(thL,thU)
return(basicCI)
}
xsamples = list()
for(i in 1:50){
xsamples[[i]] <- rexp(100,rate = 100)
}
View(xsamples)
xsamples[[1]]
basicCIfx(xsamples[[1]])
lapply(xsamples,basicCIfx)
basicCIlist <- lapply(xsamples,basicCIfx)
basicCIdf <- as.data.frame(basicCIlist)
View(basicCIdf)
basicCIlist <- lapply(xsamples,basicCIfx)
basicCIdf <- as.data.frame(t(basicCIlist))
View(basicCIdf)
basicCIdf <- as.data.frame(basicCIlist)
basicCIdf <- t(basicCIdf)
colnames(basicCIdf) <- c(L,U)
colnames(basicCIdf) <- c("L","U")
basicCoverage <- sum(basicCIdf$L <= 1/100 & 1/100 <= basicCIdf$U) / length(basicCIdf$L)
View(basicCIdf)
basicCIdf <- as.data.frame(basicCIdf)
View(basicCIdf)
colnames(basicCIdf) <- c("L","U")
basicCoverage <- sum(basicCIdf$L <= 1/100 & 1/100 <= basicCIdf$U) / length(basicCIdf$L)
expCIfx <- function(x){
n <- length(x)
xbar <- mean(x)
lambda_hat <- 1 / xbar
B <- 10000
boot_mat <- matrix(rexp(B * n, rate = lambda_hat), nrow = B, ncol = n)
boot_means <- rowMeans(boot_mat)
ci_percentile <- quantile(boot_means, c(0.025, 0.975))
return(ci_percentile)
}
expCIlist <- lapply(xsamples,expCIfx)
expCIdf <- as.data.frame(expCIlist)
View(basicCIlist)
View(expCIdf)
expCIdf <- as.data.frame(t(expCIdf))
View(expCIdf)
expCoverage <- sum(expCIdf[,1] <= 1/100 & 1/100 <= expCIdf[,2]) / length(expCIdf[,1])
basicWidth <- mean(basicCIdf$U - basicCIdf$L)
expWidth <- mean(expCIdf[,2] - expCIdf[,1])
#q2 part b
rm(list=ls())
basicCIfx <- function(x){
n= length(x)
thest = mean(x)
B = 9999
thestS = numeric(B)
thestS = rep(0,times =B)
for (i in 1:B)
thestS[i] = mean(sample(x,replace=T))
RS = sort(thestS-thest)
LRS = RS[250]
URS = RS[9750]
thL = thest-URS
thU = thest-LRS
basicCI <- c(thL,thU)
return(basicCI)
}
expCIfx <- function(x){
n <- length(x)
xbar <- mean(x)
lambda_hat <- 1 / xbar
B <- 10000
boot_mat <- matrix(rexp(B * n, rate = lambda_hat), nrow = B, ncol = n)
boot_means <- rowMeans(boot_mat)
ci_percentile <- quantile(boot_means, c(0.025, 0.975))
return(ci_percentile)
}
xsamples = list()
for(i in 1:50){
xsamples[[i]] <- rexp(100,rate = 100)
}
basicCIlist <- lapply(xsamples,basicCIfx)
basicCIdf <- as.data.frame(basicCIlist)
basicCIdf <- t(basicCIdf)
basicCIdf <- as.data.frame(basicCIdf)
colnames(basicCIdf) <- c("L","U")
basicCoverage <- sum(basicCIdf$L <= 1/100 & 1/100 <= basicCIdf$U) / length(basicCIdf$L)
basicWidth <- mean(basicCIdf$U - basicCIdf$L)
expCIlist <- lapply(xsamples,expCIfx)
expCIdf <- as.data.frame(expCIlist)
expCIdf <- as.data.frame(t(expCIdf))
expCoverage <- sum(expCIdf[,1] <= 1/100 & 1/100 <= expCIdf[,2]) / length(expCIdf[,1])
expWidth <- mean(expCIdf[,2] - expCIdf[,1])
rm(list=ls())
dpois(0:10,18.4)
sum(dpois(0:10,18.4))*150
a <- sum(dpois(0:10,18.4))*150
b <- sum(dpois(11:15,18.4))*150
c <- sum(dpois(16:20,18.4))*150
d <- sum(dpois(21:25,18.4))*150
e <- sum(dpois(26:30,18.4))*150
f <- (1 - sum(dpois(0:30,18.4)))*150
expected <- c(a,b,c,d,e,f)
g <- sum(expected)
Oa <- 5
Ob <- 34
Oc <- 64
Od <- 40
Oe <- 5
Of <- 2
observed <- c(Oa,Ob,Oc,Od,Oe,Of)
sum((observed - expected)^2 / expected)
Q <- sum((observed - expected)^2 / expected)
1-pchisq(Q,5)
p <- 1-pchisq(Q,5)
p
rm(list=ls())
a <- sum(dpois(0:10,18.4))*150
b <- sum(dpois(11:15,18.4))*150
c <- sum(dpois(16:20,18.4))*150
d <- sum(dpois(21:25,18.4))*150
e <- sum(dpois(26:30,18.4))*150
f <- (1 - sum(dpois(0:30,18.4)))*150
expected <- c(a,b,c,d,e,f)
g <- sum(expected)
Oa <- 5
Ob <- 34
Oc <- 64
Od <- 40
Oe <- 5
Of <- 2
observed <- c(Oa,Ob,Oc,Od,Oe,Of)
Q <- sum((observed - expected)^2 / expected)
p <- 1-pchisq(Q,5)
p
Q
#Q4
rm(list=ls())
x <- c(5.8, 10.1, 12.0, 12.5, 16.0, 18.6, 18.9, 19.0, 19.2, 19.6, 21.5, 22.3, 23.2, 23.3,
23.7, 24.3, 24.8, 25.2, 25.5, 25.9, 26.2, 26.3, 26.7, 26.8, 27.0, 27.1, 27.1, 27.1,
27.2, 28.1, 28.1, 28.3, 28.4, 28.4, 28.6, 28.7, 29.5, 29.6, 29.7, 30.0, 30.2, 30.2,
30.6, 30.8, 31.2, 31.5, 31.6, 31.8, 32.3, 32.4, 32.8, 33.1, 34.4, 34.6, 35.5, 36.6,
36.7, 38.0, 38.9, 39.2)
#Q4
rm(list=ls())
x <- c(5.8, 10.1, 12.0, 12.5, 16.0, 18.6, 18.9, 19.0, 19.2, 19.6, 21.5, 22.3, 23.2, 23.3,
23.7, 24.3, 24.8, 25.2, 25.5, 25.9, 26.2, 26.3, 26.7, 26.8, 27.0, 27.1, 27.1, 27.1,
27.2, 28.1, 28.1, 28.3, 28.4, 28.4, 28.6, 28.7, 29.5, 29.6, 29.7, 30.0, 30.2, 30.2,
30.6, 30.8, 31.2, 31.5, 31.6, 31.8, 32.3, 32.4, 32.8, 33.1, 34.4, 34.6, 35.5, 36.6,
36.7, 38.0, 38.9, 39.2)
n= length(x)
m= sum(x<30)
thest = m/n
B = 9999
thestS = numeric(B)
thestS = rep(0,times =B)
for (i in 1:B)
thestS[i] = sum(sample(x,replace=T)<30)/n
RS = sort(thestS-thest)
LRS = RS[250]
URS = RS[9750]
thL = thest-URS
thU = thest-LRS
thest
thL
thU
CI <- c(thL,thest,thU)
CI
#Q4
rm(list=ls())
x <- c(5.8, 10.1, 12.0, 12.5, 16.0, 18.6, 18.9, 19.0, 19.2, 19.6, 21.5, 22.3, 23.2, 23.3,
23.7, 24.3, 24.8, 25.2, 25.5, 25.9, 26.2, 26.3, 26.7, 26.8, 27.0, 27.1, 27.1, 27.1,
27.2, 28.1, 28.1, 28.3, 28.4, 28.4, 28.6, 28.7, 29.5, 29.6, 29.7, 30.0, 30.2, 30.2,
30.6, 30.8, 31.2, 31.5, 31.6, 31.8, 32.3, 32.4, 32.8, 33.1, 34.4, 34.6, 35.5, 36.6,
36.7, 38.0, 38.9, 39.2)
n= length(x)
m= sum(x<30)
thest = m/n
B = 9999
thestS = numeric(B)
thestS = rep(0,times =B)
for (i in 1:B)
thestS[i] = sum(sample(x,replace=T)<30)/n
RS = sort(thestS-thest)
LRS = RS[250]
URS = RS[9750]
thL = thest-URS
thU = thest-LRS
CI <- c(thL,thest,thU)
CI
rm(list=ls())
x <- c(5.8, 10.1, 12.0, 12.5, 16.0, 18.6, 18.9, 19.0, 19.2, 19.6, 21.5, 22.3, 23.2, 23.3,
23.7, 24.3, 24.8, 25.2, 25.5, 25.9, 26.2, 26.3, 26.7, 26.8, 27.0, 27.1, 27.1, 27.1,
27.2, 28.1, 28.1, 28.3, 28.4, 28.4, 28.6, 28.7, 29.5, 29.6, 29.7, 30.0, 30.2, 30.2,
30.6, 30.8, 31.2, 31.5, 31.6, 31.8, 32.3, 32.4, 32.8, 33.1, 34.4, 34.6, 35.5, 36.6,
36.7, 38.0, 38.9, 39.2)
n= length(x)
thest = median(x)
B = 9999
thestS = numeric(B)
thestS = rep(0,times =B)
for (i in 1:B)
thestS[i] = median(sample(x,replace=T))
RS= sort(thestS-thest)
LRS = RS[250]
URS = RS[9750]
thL = thest-URS
thU = thest-LRS
CI <- c(thL,thest,thU)
CI
median(x)
library(dplyr)
library(tidyr)
library(plotrix)
library(ggplot2)
library(viridis)
rm(list=ls())
railpa <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/railpa.csv")
railpa <- railpa[,c(8,9,10,12)]
colnames(railpa)[4] <- "rail passengers (millions passenger-kilometers)"
colnames(railpa)[2] <- "country"
roadpa <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/roadpa.csv")
roadpa <- roadpa[,c(10,11,12,14)]
colnames(roadpa)[4] <- "road passengers (millions passenger-kilometers)"
colnames(roadpa)[2] <- "country"
railacc <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/railaccidents.csv")
railacc <- railacc[,c(14,15,16,18)]
colnames(railacc)[4] <- "rail accidents"
colnames(railacc)[2] <- "country"
roadacc <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/roadaccidents.csv")
roadacc <- roadacc[,c(10,11,12,14)]
colnames(roadacc)[2] <- "country"
colnames(roadacc)[4] <- "road accidents"
CRI <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/CRI.csv")
CRI <- CRI[,c(2,3)]
colnames(CRI)[1] <- "country"
GDP <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/gdpdata.csv")
GDPLong <- GDP %>%
pivot_longer(
cols = starts_with("X20"),
names_to = "TIME_PERIOD",
values_to = "gdp"
) %>%
mutate(TIME_PERIOD = as.integer(sub("X","",TIME_PERIOD)))
colnames(GDPLong)[1] <- "country"
area <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/area.csv")
area <- area[,c(6,8)]
colnames(area) <- c("geo","area")
substr(area$geo[1],1,2)
for(i in 1:length(area$geo)){
area$geo[i] <- substr(area$geo[i],1,2)
}
allpa <- merge(railpa,roadpa,by=c("geo","country","TIME_PERIOD"),all = TRUE)
railaccallpa <- merge(railacc,allpa,by=c("geo","country","TIME_PERIOD"),all=TRUE)
safetyDFALL <- merge(roadacc,railaccallpa,by=c("geo","country","TIME_PERIOD"),all=TRUE)
CRIMerge <- merge(safetyDFALL,CRI,by="country")
GDPMerge <- merge(CRIMerge,GDPLong,by=c("country","TIME_PERIOD"),all=TRUE)
areaMerge <- merge(GDPMerge,area,by="geo",all=TRUE)
safetyDF <- areaMerge[complete.cases(areaMerge),]
safetyDF$roadAccByVol <- safetyDF$`road accidents` / safetyDF$`road passengers (millions passenger-kilometers)`
safetyDF$railAccByVol <- safetyDF$`rail accidents` / safetyDF$`rail passengers (millions passenger-kilometers)`
safetyDF$ratio <- safetyDF$roadAccByVol / safetyDF$railAccByVol
safetyByYear <- safetyDF %>%
group_by(TIME_PERIOD) %>%
summarise(across(c(`road accidents`,`road passengers (millions passenger-kilometers)`,`rail accidents`,`rail passengers (millions passenger-kilometers)`),sum),
ratio = mean(`ratio`, na.rm=TRUE), CRI.score = mean(`CRI.score`,na.rm=TRUE),gdp = mean(`gdp`,na.rm=TRUE),area = mean(`area`,na.rm=TRUE))
safetyByYear$roadAccByVol <- safetyByYear$`road accidents`/ safetyByYear$`road passengers (millions passenger-kilometers)`
safetyByYear$railAccByVol <- safetyByYear$`rail accidents` / safetyByYear$`rail passengers (millions passenger-kilometers)`
plot(safetyByYear$TIME_PERIOD, safetyByYear$roadAccByVol,type="l",col="red",ylim=c(0,0.009),xlab="Year", ylab="accidents by volume",main="Fig 2.1")
lines(safetyByYear$TIME_PERIOD, safetyByYear$railAccByVol,type="l",col="blue")
points(safetyByYear$TIME_PERIOD, safetyByYear$roadAccByVol,col="red",pch=19)
points(safetyByYear$TIME_PERIOD, safetyByYear$railAccByVol,col="blue",pch=19)
legend("topright",legend=c("Road Accidents by Volume", "Rail Accidents by Volume"),col=c("red","blue"),pch=c(19,19))
safetyByGeo <- safetyDF %>%
group_by(geo) %>%
summarise(across(c(`road accidents`,`road passengers (millions passenger-kilometers)`,`rail accidents`,`rail passengers (millions passenger-kilometers)`),sum))
safetyByGeo$roadAccByVol <- safetyByGeo$`road accidents` / safetyByGeo$`road passengers (millions passenger-kilometers)`
safetyByGeo$railAccByVol <- safetyByGeo$`rail accidents` / safetyByGeo$`rail passengers (millions passenger-kilometers)`
safetyByGeo$ratio <- safetyByGeo$roadAccByVol / safetyByGeo$railAccByVol
top5 <- order(safetyByGeo$ratio, decreasing = TRUE)[1:5]
safetyByGeo$roadAccByVol[top5]
safetyByGeo$geo[top5]
safetyByGeo$railAccByVol[top5]
ncol(rbind(safetyByGeo$roadAccByVol[top5],safetyByGeo$railAccByVol[top5]))
length(safetyByGeo$geo[top5])
par(mfrow = c(1,2))
barplot( rbind(safetyByGeo$roadAccByVol[top5],safetyByGeo$railAccByVol[top5]),
names.arg=paste0(safetyByGeo$geo[top5],"/n",round(safetyByGeo$ratio[top5],digits=3)),
beside = TRUE, col=c("red","blue"), legend.text=c("Road Acc by Volume", "Rail Acc by Volume"),
args.legend = list(x = "topleft"),main="Fig 2.2")
bot5 <- order(safetyByGeo$ratio, decreasing = FALSE)[1:5]
safetyByGeo$roadAccByVol[bot5]
safetyByGeo$geo[bot5]
safetyByGeo$railAccByVol[bot5]
ncol(rbind(safetyByGeo$roadAccByVol[bot5],safetyByGeo$railAccByVol[bot5]))
length(safetyByGeo$geo[bot5])
barplot( rbind(safetyByGeo$roadAccByVol[bot5],safetyByGeo$railAccByVol[bot5]),
names.arg=paste0(safetyByGeo$geo[bot5],"/n",round(safetyByGeo$ratio[bot5],digits=3)),
beside = TRUE, col=c("red","blue"), legend.text=c("Road Acc by Volume", "Rail Acc by Volume"),
args.legend = list(x = "topright"),main="Fig 2.3")
safetyDF <- safetyDF[order(safetyDF$TIME_PERIOD,decreasing = FALSE),]
safetyyrsplit <- split(safetyDF,safetyDF$TIME_PERIOD)
safetyt <- function(df){
return(t.test(df$ratio,mu=1,alternative="greater"))
}
safetyt2side <- function(df){
return(t.test(df$ratio,mu=1))
}
tlist <- sapply(safetyyrsplit,safetyt)
tsig <- tlist[3,] < 0.05
tlist2side <- sapply(safetyyrsplit,safetyt2side)
viztable <-cbind(tlist[3,],tsig,tlist[2,],tlist2side[4,])
colnames(viztable) <- c("p val", "significant", "n-1","confidence interval")
safetyyrsplit[["2009"]]
write.csv(viztable, "C:/Users/Saketh/Documents/STAT482/safety/viztable.csv")
fixtable <- read.csv("C:/Users/Saketh/Documents/STAT482/safety/viztablemodded.csv")
fixtable <- fixtable %>%
rowwise() %>%
mutate(CI = list(c(lowlevel,highlevel))) %>%
ungroup()
par(mfrow=c(1,1))
plot(safetyByYear$TIME_PERIOD,safetyByYear$ratio,ylim=c(0,6),type="l",col="red",main="Ratio by Year")
points(safetyByYear$TIME_PERIOD,safetyByYear$ratio,col="red",pch=19)
abline(h=1,lty=2)
segments(x0 = fixtable$year,y0 = fixtable$lowlevel, y1=fixtable$highlevel,col = "blue", lwd = 2)
arrows(x0 = fixtable$year,y0 = fixtable$lowlevel, y1=fixtable$highlevel,col = "blue", angle = 90, code = 3, length = 0.05, lwd=2)
fixtable$width <- fixtable$highlevel - fixtable$lowlevel
fixtable$year[order(fixtable$width,decreasing = TRUE)]
mean(safetyDF[safetyDF$TIME_PERIOD == 2008,]$ratio)
lms <- list()
shapiro <- list()
shapiroP <- c()
coeffsList <- list()
r2list <- c()
lmpvalList <- list()
predRat <- c()
for(i in min(safetyDF$TIME_PERIOD):max(safetyDF$TIME_PERIOD)){
currlm <- lm(data = safetyDF[safetyDF$TIME_PERIOD == i,], formula = ratio ~ CRI.score + gdp + area)
lms <- c(lms,list(summary(currlm)))
shapiro <- c(shapiro,list(t(shapiro.test(resid(currlm)))))
shapiroP <- c(shapiroP,shapiro.test(resid(currlm))$p.value)
coeffsList <- c(coeffsList,list(t(currlm$coefficients)))
lmpvalList <- c(lmpvalList,list(t(summary(currlm)$coefficients[,4])))
predRat <- c(predRat,predict(currlm,newdata = safetyByYear[safetyByYear$TIME_PERIOD == i,7:9]))
r2list <- c(r2list,summary(currlm)$r.squared)
#print(i)
#print(currlm$coefficients)
#print(predict(currlm,newData=safetyByYear[safetyByYear$TIME_PERIOD == i,7:9]))
#coeffs[j] <- as.data.frame(t(currlm$coefficients))
#lmpval[j] <- summary(currlm)[,4]
}
coeffs <- do.call(rbind,lapply(coeffsList,as.data.frame))
lmpval <- do.call(rbind,lapply(lmpvalList,as.data.frame))
sigCoeff <- lmpval[,2:4] < 0.05
# use write.table to output the coefficients into a table
# take average cri, gdp, and area for each year to get the ybar for each year. we can track this throughout years in order to see how the "average country" changes over the years
# dont have a separate tablefor each one in the report, pick significantly interesting years.
shapiroP < 0.05
shapiroP
r2df <- cbind(min(safetyDF$TIME_PERIOD):max(safetyDF$TIME_PERIOD),r2list)
View(safetyDF[safetyDF$TIME_PERIOD == 2016,])
plot(lm(data = safetyDF[safetyDF$TIME_PERIOD == 2016,], formula = ratio ~ CRI.score + gdp + area))
yearlyPred <- cbind(min(safetyDF$TIME_PERIOD):max(safetyDF$TIME_PERIOD),predRat)
colnames(yearlyPred) <- c("TIME_PERIOD", "pred")
ggplot(yearlyPred, aes(x = TIME_PERIOD, y= pred))+
geom_line(col="steelblue")+
geom_point(col="steelblue")+
theme_minimal()+
labs(
)
# new EDA (CRI,GDP,Area)
EuroCRI <- as.data.frame(cbind(unique(safetyDF$country), unique(safetyDF$CRI.score), unique(safetyDF$geo)))
colnames(EuroCRI) <- c("country", "CRI.score", "geo")
EuroCRI$CRI.score <- as.numeric(EuroCRI$CRI.score)
EuroCRI <- EuroCRI[order(EuroCRI$CRI.score, decreasing = TRUE),]
ggplot(EuroCRI, aes(x=reorder(geo,-CRI.score),y=CRI.score))+
geom_bar(stat = "identity",fill="lightcoral")+
labs(title = "CRI Score by Country",
x = "country",
y = "CRI Score")
ggplot(GDPLong, aes(x = TIME_PERIOD, y = gdp, color = country, group = country)) +
geom_line()+
geom_point()+
labs(title = "GDP per capita over time",
x = "Year",
y = "GDP per capita",
color = "Country")+
scale_color_viridis(discrete = TRUE, option = "A") +
theme_dark()
length(unique(safetyDF$TIME_PERIOD))
write.csv(fixtable,file="fixtable.csv")
View(safetyDF[safetyDF$TIME_PERIOD == 2020,])
head(shapiroP)
head(lms)
capture.output(shapiro,file="shapiro.txt")
capture.output(lms,file = "lms.txt")
safetyDF$gdp <- log(safetyDF$gdp)
safetyDF$area <-log(safetyDF$area)
library(lme4)
library(lmerTest)
lin1 <- lmer(ratio ~  area + gdp + (1 | geo) ,data=safetyDF[-1,])
lin1
summary(lin1)
ranef(lin1)
fixef(lin1)
anova(lin1)
library(merTools)
predictInterval(lin1,newdata = safetyDF[1,])
library(modelsummary)
get_gof(lin1)
plot(lin1)
qqnorm(resid(lin1))
qqline(resid(lin1))
lin2 <- lmer(ratio ~ area + gdp + area*gdp + (1 | geo),data=safetyDF[,])
lin2
summary(lin2)
View(safetyDF)
View(safetyByGeo)
summary(lin1)
anova(lin1)
fixef(lin1)
get_gof(lin1)
pr(mfrow=c(2,1))
par(mfrow=c(2,1))
qqnorm(resid(lin1))
qqline(resid(lin1))
plot(lin1)
qqnorm(resid(lin1))
qqline(resid(lin1))
pr(mfrow=c(1,1))
par(mfrow=c(1,1))
plot(lin1)
timeDF$ratio <- timeDF$Rail..hrs./timeDF$Flight..hrs.
rm(list=ls())
library(scales)
library(dplyr)
timeDF <- read.csv("C:/Users/Saketh/Documents/STAT482/time/railairdata.csv")
timeDF$HSR <- timeDF$Avg.rail.speed..km.h. > 200
group = as.factor(timeDF$HSR)
plot(x=timeDF$Rail..hrs.,y=timeDF$Flight..hrs.,col=alpha(c("red","blue")[group],alpha = 0.3),pch=19,main="Fig 3.1",
ylab = "Flight Duration (hrs)", xlab = "Rail Duration (hrs)")
abline(a=0,b=1,col="green")
legend("topright",legend=c("High Speed Rail (>200 kmh)", "Conventional Rail (<200 kmh)"),col=c("blue","red"),pch=c(19,19))
plot(x=timeDF$Dist.km.,y=timeDF$Rail..hrs./timeDF$Flight..hrs.,col=alpha(c("red","blue")[group],alpha = 0.3),pch=19,
main="Fig 3.2", xlab="Distance (km)",ylab="Time Ratio (Rail/Flight) (hrs)")
abline(h=1,col="green")
legend("topleft",legend=c("High Speed Rail (>200 kmh)", "Conventional Rail (<200 kmh)"),col=c("blue","red"),pch=c(19,19))
hsridx <- timeDF$HSR
crt <- t.test(timeDF[!hsridx,]$Rail..hrs.,timeDF[!hsridx,]$Flight..hrs.,paired=TRUE)
hsrt <- t.test(timeDF[hsridx,]$Rail..hrs.,timeDF[hsridx,]$Flight..hrs.,paired=TRUE)
timeDF$ratio <- timeDF$Rail..hrs./timeDF$Flight..hrs.
hsrlin <- lm(ratio ~ log(Dist.km.),data=timeDF[hsridx,])
plot(hsrlin)
summary(hsrlin)
crlin <- lm(ratio ~ log(Dist.km.),data=timeDF[!hsridx,])
plot(crlin)
shapiro.test(resid(crlin))
shapiro.test(resid(hsrlin))
summary(hsrlin)
crlin <- lm(ratio ~ log(Dist.km.),data=timeDF[!hsridx,])
shapiro.test(resid(crlin))
summary(crlin)
exp((1+2.1934) / 0.511)
source("C:/Users/Saketh/Documents/STAT482/time/captime.R")
#timeDF$diff = timeDF$Rail..hrs. - timeDF$Flight..hrs.
#lm(timeDF$diff ~ timeDF$Dist.km.)
#plot(lm(timeDF$diff ~ timeDF$Dist.km.))
#shapiro.test(resid(lm(timeDF$diff ~ timeDF$Dist.km.)))
usdist <- read.csv("C:/Users/Saketh/Documents/STAT482/time/USairportdist.csv")
View(usdist)
ausdist <- usdist[usdist$ORIGIN=="AUS",]
View(ausdist)
usdist$Dist.km. <- usdist$DISTANCE.IN.MILES * 1.60934
ausdist <- usdist[usdist$ORIGIN=="AUS",]
midrangeflights <- usdist[usdist$Dist.km. >= 200 & usdist$Dist.km. < 600,]
View(midrangeflights)
sample(midrangeflights)
sample(midrangeflights,n=1000)
fsample <- sample(midrangeflights,size=1000)
fsample <- sample(midrangeflights$Dist.km.,size=1000)
?predict
predict(hsrlin,fsample)
predict(hsrlin,data=fsample)
predict(hsrlin,data=fsample[1])
predict(hsrlin,data=log(fsample))
predict(hsrlin,newdata=log(fsample))
predict(hsrlin,newdata=list(log(fsample)))
fsample <- midrangeflights[sample(1:length(midrangeflights$Dist.km.),size=1000),]
predict(hsrlin,newdata=fsample)
hsrpred <- predict(hsrlin,newdata=fsample)
crpred <- predict(crlin,newdata=fsample)
summary(hsrpred)
summary(crpred)
sum(hsrpred >= 1) / length(hsrpred)
sum(crpred >= 1) / length(crpred)
sd(hsrpred)
sd(crpred)
